!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","react-dom"],t):"object"==typeof exports?exports.ReactAMAP=t(require("react"),require("react-dom")):e.ReactAMAP=t(e.React,e.ReactDOM)}(this,function(e,t){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=8)}([function(t,n){t.exports=e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return!!e&&"function"==typeof e};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={MARKER_ID_CONFLICT:"Marker 的 id 属性重复",MARKER_ID_REQUIRED:"每一个 Marker 必需有一个 id 属性",MAP_INSTANCE_REQUIRED:"没有地图实例；组件必须作为 Map 的子组件使用",CIRCLE_INSTANCE_REQUIRED:"",CIRCLE_CENTER_REQUIRED:"Circle 组件必需设置 center 属性",CIRCLE_RADIUS_REQUIRED:"Circle 组件必需设置 radius 属性",SRC_REQUIRED:"GroundImage 组件必需设置 src 属性",BOUNDS_REQUIRED:"GroundImage 组件必需设置 bounds 属性",WINDOW_POSITION_REQUIRED:"InfoWindow 组件必需设置 position 属性",INVALID_AMAP_PLUGIN:"plugins 属性不正确；目前支持的插件有'Scale', 'ToolBar', 'MapType', 'OverView'"},i=function(e){return e in r?r[e]:e},o={error:function(e){throw new Error(i(e))},warning:function(e){console.warn(i(e))},optimize:function(e){console.log("%c"+i(e),"color:#d4d483;border-left: 2px solid #d4d483;padding-left: 4px;")}};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="undefined"!=typeof window,i=t.getAMapPosition=function(e){if(!e)return e;if("getLng"in e&&"getLat"in e)return e;var t=0,n=0;return"[object Array]"==={}.toString.call(e)?(t=e[0],n=e[1]):"lng"in e&&"lat"in e?(t=e.lng,n=e.lat):"longitude"in e&&"latitude"in e&&(t=e.longitude,n=e.latitude),r?new window.AMap.LngLat(t,n):null},o=t.getAMapPixel=function(e){if(!e)return e;if("getX"in e&&"getY"in e)return e;var t=0,n=0;return"[object Array]"==={}.toString.call(e)&&(t=e[0],n=e[1]),r?new window.AMap.Pixel(t,n):null},a=t.getAMapSize=function(e){return e?"getWidth"in e?e:r?new window.AMap.Size(e.width,e.height):null:e};t.default={getAMapPosition:i,getAMapPixel:o,getAMapSize:a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e[0].toUpperCase()+e.slice(1,e.length)};t.default=r},function(e,n){e.exports=t},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(l),c=n(1),f=r(c),p=n(2),d=r(p),h=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return"undefined"!=typeof window&&(e.__map__&&e.__poly__?(n.map=e.__map__,n.element=e.__ele__,n.poly=e.__poly__,n.editorActive=!1,n.onPropsUpdate(e)):d.default.warning("MAP_INSTANCE_REQUIRED")),n}return a(t,e),u(t,[{key:"componentWillReceiveProps",value:function(e){this.map&&this.onPropsUpdate(e)}},{key:"onPropsUpdate",value:function(e){"active"in e&&!1===e.active?this.toggleActive(!1,e):this.toggleActive(!0,e)}},{key:"toggleActive",value:function(e,t){e?this.editorActive||this.activeEditor(t):this.editorActive&&this.inactiveEditor()}},{key:"activeEditor",value:function(e){var t=this;this.loadPolyEditor(e).then(function(e){t.editorActive=!0,e.open()})}},{key:"inactiveEditor",value:function(){this.editorActive=!1,this.polyEditor&&this.polyEditor.close()}},{key:"loadPolyEditor",value:function(e){var t=this;return this.polyEditor?Promise.resolve(this.polyEditor):new Promise(function(n){t.map.plugin(["AMap.PolyEditor"],function(){n(t.createEditorInstance(e))})})}},{key:"createEditorInstance",value:function(e){this.polyEditor=new window.AMap.PolyEditor(this.map,this.poly);var t=this.exposeEditorInstance(e);return t&&this.bindEditorEvents(t),this.polyEditor}},{key:"exposeEditorInstance",value:function(e){if("events"in e){var t=e.events||{};return(0,f.default)(t.created)&&t.created(this.polyEditor),delete t.created,t}return!1}},{key:"bindEditorEvents",value:function(e){var t=this,n=Object.keys(e);n.length&&n.forEach(function(n){t.polyEditor.on(n,e[n])})}},{key:"render",value:function(){return null}}]),t}(s.Component);t.default=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.renderMarkerComponent=t.getPropValue=t.MarkerAllProps=t.MarkerConfigurableProps=void 0;var i=n(3),o=n(0),a=r(o),u=n(5),l=n(1),s=r(l),c=t.MarkerConfigurableProps=["position","offset","icon","content","draggable","visible","zIndex","angle","animation","shadow","title","clickable","extData","label"],f=t.MarkerAllProps=c.concat(["topWhenClick","bubble","raiseOnDrag","cursor","autoRotation","shape"]);t.getPropValue=function(e,t){return-1===f.indexOf(e)?null:"position"===e?(0,i.getAMapPosition)(t):"offset"===e?(0,i.getAMapPixel)(t):t},t.renderMarkerComponent=function(e,t){var n=e;if((0,s.default)(e)){n=e(t.getExtData())}(0,u.render)(a.default.createElement("div",null,n),t.getContent())}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.MouseTool=t.Marker=t.GroundImage=t.InfoWindow=t.PolyEditor=t.Polyline=t.Polygon=t.CircleEditor=t.Circle=t.Markers=t.Map=void 0;var i=n(9),o=r(i),a=n(11),u=r(a),l=n(12),s=r(l),c=n(13),f=r(c),p=n(14),d=r(p),h=n(15),v=r(h),y=n(16),m=r(y),b=n(17),_=r(b),k=n(18),g=r(k),w=n(6),M=r(w),C=n(19),E=r(C);t.Map=o.default,t.Markers=s.default,t.Circle=f.default,t.CircleEditor=g.default,t.Polygon=d.default,t.Polyline=v.default,t.PolyEditor=M.default,t.InfoWindow=m.default,t.GroundImage=_.default,t.Marker=u.default,t.MouseTool=E.default,t.default={Map:o.default,Markers:s.default,Circle:f.default,CircleEditor:g.default,Polygon:d.default,Polyline:v.default,PolyEditor:M.default,InfoWindow:m.default,GroundImage:_.default,Marker:u.default,MouseTool:E.default}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(c),p=n(10),d=r(p),h=n(1),v=r(h),y=n(2),m=r(y),b=n(4),_=r(b),k=n(3),g=f.Component,w=f.Children,M={width:"100%",height:"100%"},C={width:"100%",height:"100%",position:"relative"},E=["layers","zoom","center","labelzIndex","mapStyle","features","cursor","pitch"],O=["city","bounds","limitBounds","status","rotation"],P=["animateEnable","doubleClickZoom","dragEnable","isHotspot","jogEnable","keyboardEnable","resizeEnable","rotateEnable","scrollWheel","touchZoom","zoomEnable"],j=["view","zooms","showIndoorMap","indoorMap","expandZoomRange","showBuildingBlock","viewMode","pitchEnable","buildingAnimation","skyColor"],I=E.concat(P,j),A={MapType:{showRoad:!1,showTraffic:!1,defaultType:0},ToolBar:{position:"RB",noIpLocate:!0,locate:!0,liteStyle:!0,autoPosition:!1},OverView:{},ControlBar:{}},x=function(e){function t(e){o(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={mapLoaded:!1},"undefined"!=typeof window&&(n.pluginMap={},n.loader=new d.default(e.amapkey,e.useAMapUI).load()),n}return u(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){var t=this,n=this.props;this.loader.then(function(){t.map&&t.updateMapProps(n,e)})}},{key:"componentDidMount",value:function(){this.loadMap()}},{key:"componentDidUpdate",value:function(){this.loadMap()}},{key:"loadMap",value:function(){var e=this;this.loader.then(function(){e.initMapInstance(),e.state.mapLoaded||e.setState({mapLoaded:!0})})}},{key:"renderChildren",value:function(){var e=this;return w.map(this.props.children,function(t){if(t){var n=t.type;return n.preventAmap||"string"==typeof n?t:f.cloneElement(t,{__map__:e.map,__ele__:e.mapWrapper})}return t})}},{key:"initMapInstance",value:function(){var e=this;if(!this.map){var t=this.buildCreateOptions();this.map=new window.AMap.Map(this.mapWrapper,t);var n=this.exposeMapInstance();n&&this.bindAMapEvents(n),this.setPlugins(this.props),O.forEach(function(t){if(t in e.props){var n=e.getSetterValue(t,e.props);e.runMapSetter(t,n)}})}}},{key:"buildCreateOptions",value:function(){var e=this,t=this.props,n={};return I.forEach(function(r){r in t&&(n[r]=e.getSetterValue(r,t))}),n}},{key:"bindAMapEvents",value:function(e){var t=this,n=Object.keys(e);n.length&&n.forEach(function(n){t.map.on(n,e[n])})}},{key:"updateMapProps",value:function(e,t){var n=this,r={},i=!1,o=!1;P.forEach(function(a){a in t&&(o=!0,n.detectPropChanged(a,e,t)&&(i=!0,r[a]=t[a]))}),i&&this.map.setStatus(r),o&&"status"in t&&m.default.warning("以下这些属性可以单独提供进行配置，也可以统一作为‘status’属性配置；但是请不要同时使用这两种方式。\n（"+P.join(", ")+"）"),E.concat(O).forEach(function(r){if(r in t&&n.detectPropChanged(r,e,t)){var i=n.getSetterValue(r,t);n.runMapSetter(r,i)}}),j.forEach(function(r){r in t&&n.detectPropChanged(r,e,t)&&m.default.warning("'"+r+"' 是一个静态属性，地图实例创建成功后无法修改")}),this.setPlugins(t)}},{key:"runMapSetter",value:function(e,t){if("limitBounds"!==e||t){var n=this.getSetterName(e);this.map[n](t)}else this.map.clearLimitBounds()}},{key:"getSetterValue",value:function(e,t){return"center"===e?(0,k.getAMapPosition)(t.center):t[e]}},{key:"getSetterName",value:function(e){switch(e){case"labelzIndex":return"setlabelzIndex";case"cursor":return"setDefaultCursor";default:return"set"+(0,_.default)(e)}}},{key:"detectPropChanged",value:function(e,t,n){return t[e]!==n[e]}},{key:"setPlugins",value:function(e){var t=this,n=["Scale","ToolBar","MapType","OverView","ControlBar"];if("plugins"in e){var r=e.plugins;r&&r.length&&r.forEach(function(e){var r=void 0,i=void 0,o=void 0;"string"==typeof e?(r=e,i=null,o=!0):(r=e.name,i=e.options||{},o=!("visible"in i&&"boolean"==typeof i.visible)||i.visible,delete i.visible);var a=n.indexOf(r);-1===a?m.default.warning("没有 ‘"+r+"’ 这个插件，请检查是否拼写错误"):o&&(n.splice(a,1),t.installPlugin(r,i))})}this.removeOrDisablePlugins(n)}},{key:"removeOrDisablePlugins",value:function(e){var t=this;e&&e.length&&e.forEach(function(e){e in t.pluginMap&&("ControlBar"===e?(t.map.removeControl(t.pluginMap[e]),delete t.pluginMap[e]):t.pluginMap[e].hide())})}},{key:"installPlugin",value:function(e,t){switch(t=t||{},e){case"Scale":case"ToolBar":case"OverView":case"MapType":this.setMapPlugin(e,t);break;case"ControlBar":this.setControlBar(t)}}},{key:"setMapPlugin",value:function(e,t){var n=this;if(this.pluginMap[e])this.pluginMap[e].show();else{var r=t.onCreated,o=i(t,["onCreated"]),a=l({},A[e],o);this.map.plugin(["AMap."+e],function(){n.pluginMap[e]=new window.AMap[e](a),n.map.addControl(n.pluginMap[e]),(0,v.default)(r)&&r(n.pluginMap[e])})}}},{key:"setControlBar",value:function(e){var t=this;if(this.pluginMap.ControlBar);else{var n=e.onCreated,r=i(e,["onCreated"]),o=l({},A.ControlBar,r);this.map.plugin(["AMap.ControlBar"],function(){t.pluginMap.ControlBar=new window.AMap.ControlBar(o),t.map.addControl(t.pluginMap.ControlBar),(0,v.default)(n)&&n(t.pluginMap.ControlBar)})}}},{key:"exposeMapInstance",value:function(){if("events"in this.props){var e=this.props.events||{};return(0,v.default)(e.created)&&(e.created(this.map),delete e.created),e}return!1}},{key:"render",value:function(){var e=this;return f.createElement("div",{style:C},f.createElement("div",{ref:function(t){e.mapWrapper=t},style:M},this.state.mapLoaded?null:this.props.loading||null),f.createElement("div",null,this.state.mapLoaded?this.renderChildren():null))}},{key:"componentWillUnmount",value:function(){this.map.destroy()}}]),t}(g);t.default=x},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o={v:"1.4.0",hostAndPath:"webapi.amap.com/maps",key:"f97efc35164149d0c0f299e7a8adb3d2",callback:"__amap_init_callback",useAMapUI:!1},a=null,u=null,l=!1,s=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r(this,e),this.config=o,this.config.useAMapUI=n,"undefined"!=typeof window&&(t?this.config.key=t:"amapkey"in window&&(this.config.key=window.amapkey))}return i(e,[{key:"getScriptSrc",value:function(e){return window.location.protocol+"//"+e.hostAndPath+"?v="+e.v+"&key="+e.key+"&callback="+e.callback}},{key:"buildScriptTag",value:function(e){var t=document.createElement("script");return t.type="text/javascript",t.async=!0,t.defer=!0,t.src=e,t}},{key:"getAmapuiPromise",value:function(){var e=this.buildScriptTag(window.location.protocol+"//webapi.amap.com/ui/1.0/main-async.js"),t=new Promise(function(t){e.onload=function(){t()}});return document.body.appendChild(e),t}},{key:"getMainPromise",value:function(){var e=this,t=this.buildScriptTag(this.getScriptSrc(this.config)),n=new Promise(function(t){window[e.config.callback]=function(){t(),delete window[e.config.callback]}});return document.body.appendChild(t),n}},{key:"load",value:function(){if("undefined"==typeof window)return null;var e=this.config.useAMapUI;return a=a||this.getMainPromise(),e&&(u=u||this.getAmapuiPromise()),new Promise(function(t){a.then(function(){e&&u?u.then(function(){window.initAMapUI&&!l&&(window.initAMapUI(),l=!0),t()}):t()})})}}]),e}();t.default=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(s),f=n(5),p=n(2),d=r(p),h=n(1),v=r(h),y=n(4),m=r(y),b=n(7),_=n(3),k=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return"undefined"!=typeof window&&(e.__map__?(n.map=e.__map__,n.element=n.map.getContainer(),n.createMarker(e)):d.default.warning("MAP_INSTANCE_REQUIRED")),n}return a(t,e),l(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"componentWillReceiveProps",value:function(e){this.map&&this.refreshMarkerLayout(e)}},{key:"componentDidMount",value:function(){this.map&&this.setChildComponent(this.props)}},{key:"createMarker",value:function(e){var t=this.buildCreateOptions(e);this.marker=new window.AMap.Marker(t);var n=this.exposeMarkerInstance(e);n&&this.bindMarkerEvents(n),this.marker.render=function(e){return function(t){(0,b.renderMarkerComponent)(t,e)}}(this.marker),this.setMarkerLayout(e)}},{key:"buildCreateOptions",value:function(e){var t=this,n={};return b.MarkerAllProps.forEach(function(r){r in e&&(n[r]=t.getSetterParam(r,e[r]))}),n.map=this.map,n}},{key:"setMarkerLayout",value:function(e){("render"in e||"children"in e)&&(this.createContentWrapper(),"className"in e&&e.className&&(this.contentWrapper.className=e.className))}},{key:"createContentWrapper",value:function(){this.contentWrapper=document.createElement("div"),this.marker.setContent(this.contentWrapper)}},{key:"setChildComponent",value:function(e){if(this.contentWrapper)if("className"in e&&e.className&&(this.contentWrapper.className=e.className),"render"in e)(0,b.renderMarkerComponent)(e.render,this.marker);else if("children"in e){var t=e.children,n=void 0===t?"undefined":u(t);"undefined"!==n&&this.contentWrapper&&(0,f.render)(c.createElement("div",null,t),this.contentWrapper)}}},{key:"refreshMarkerLayout",value:function(e){var t=this;b.MarkerConfigurableProps.forEach(function(n){if(t.props[n]!==e[n])if("visible"===n)e[n]?t.marker.show():t.marker.hide();else{var r=t.getSetterName(n),i=t.getSetterParam(n,e[n]);t.marker[r](i)}}),this.setChildComponent(e)}},{key:"getSetterParam",value:function(e,t){return"position"===e?(0,_.getAMapPosition)(t):"offset"===e?(0,_.getAMapPixel)(t):t}},{key:"getSetterName",value:function(e){switch(e){case"zIndex":return"setzIndex";default:return"set"+(0,m.default)(e)}}},{key:"exposeMarkerInstance",value:function(e){if("events"in e&&e.events){var t=e.events;return(0,v.default)(t.created)&&t.created(this.marker),delete t.created,t}return!1}},{key:"bindMarkerEvents",value:function(e){var t=this,n=Object.keys(e);n.length&&n.forEach(function(n){t.marker.on(n,function(t){e[n](t,t.target)})})}},{key:"render",value:function(){return null}},{key:"componentWillUnmount",value:function(){this.marker.hide(),this.marker.setMap(null),delete this.marker}}]),t}(c.Component);t.default=k},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(l),c=n(5),f=n(1),p=r(f),d=n(2),h=r(d),v=n(7);if("undefined"!=typeof window){var y=document.head||document.getElementsByTagName("head")[0],m=document.createElement("style");m.type="text/css",m.textContent=".amap_markers_pop_window{\n    padding: 10px;\n    border: 1px solid #ddd;\n    border-radius: 8px;\n    background: #fff;\n    position: relative;\n    display: flex;\n    flex-wrap: wrap;\n    justify-content: flex-start;\n}\n.amap_markers_pop_window::before{\n    content: ' ';\n    display: block;\n    position: absolute;\n    bottom: -12px;\n    left: 50%;\n    margin-left: -7px;\n    width: 0;\n    height: 0;\n    border-top: 12px solid #ddd;\n    border-left: 7px solid transparent;\n    border-right: 7px solid transparent;\n}\n.amap_markers_pop_window::after{\n    content: ' ';\n    display: block;\n    position: absolute;\n    bottom: -11px;\n    left: 50%;\n    margin-left: -6px;\n    width: 0;\n    height: 0;\n    border-top: 11px solid #fff;\n    border-left: 6px solid transparent;\n    border-right: 6px solid transparent;\n}\n.amap_markers_pop_window_item{\n    cursor:pointer;\n    width: 40px;\n    height: 50px;\n    display: flex;\n    align-items: flex-end;\n    justify-content: center;\n}\n.amap_markers_pop_window_item span{\n    pointer-events: none;\n}\n.amap_markers_window_overflow_warning{\n    text-align: center;\n    width: 100%;\n    margin: 5px 0;\n    color: #666;\n}",y.appendChild(m)}var b=s.Component,_=25.6,k=46*.8-2,g=46*.8,w=66*.8-2,M={useCluster:!1,markersCache:[],markerIDCache:[]},C=["gridSize","minClusterSize","maxZoom","averageCenter","styles","zoomOnClick"],E=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return"undefined"!=typeof window&&(e.__map__?(n.map=e.__map__,n.element=n.map.getContainer(),n.markersCache=M.markersCache,n.useCluster=null,n.markerIDCache=M.markerIDCache,n.resetOffset=new window.AMap.Pixel(-_/2,-k),n.hoverOffset=new window.AMap.Pixel(-g/2,-w),n.createMarkers(e)):h.default.warning("MAP_INSTANCE_REQUIRED")),n}return a(t,e),u(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"createMarkers",value:function(e){var t=this,n=e.markers||[],r=[],i={};n.length&&n.forEach(function(n,o){var a=t.buildCreateOptions(e,n,o);a.map=t.map;var u=null;if((0,p.default)(e.render)){var l=e.render(n);if(!1!==l){var s=document.createElement("div");s.setAttribute("__react_amap__","1"),u=s,i[o]=l}}if(!u){u=document.createElement("div");var c=document.createElement("img");c.src="//webapi.amap.com/theme/v1.3/markers/n/mark_bs.png",u.appendChild(c)}a.content=u;var f=new window.AMap.Marker(a);f.on("click",function(e){t.onMarkerClick(e)}),f.on("mouseover",function(e){t.onMarkerHover(e)}),f.on("mouseout",function(e){t.onMarkerHoverOut(e)}),f.render=function(e){return function(t){return(0,v.renderMarkerComponent)(t,e)}}(f),t.bindMarkerEvents(f),r.push(f)}),this.markersCache=r,this.markerReactChildDOM=i,this.exposeMarkerInstance(),this.checkClusterSettings(e)}},{key:"checkClusterSettings",value:function(e){var t=this;if(e.useCluster)this.loadClusterPlugin(e.useCluster).then(function(e){e.setMarkers(t.markersCache)});else if(this.mapCluster){var n=this.mapCluster.getMarkers();this.mapCluster.clearMarkers(),n.forEach(function(e){e.setMap(t.map)})}}},{key:"componentDidMount",value:function(){this.map&&this.setMarkerChild()}},{key:"setMarkerChild",value:function(){var e=this;Object.keys(this.markerReactChildDOM).forEach(function(t){var n=e.markersCache[t].getContent(),r=e.markerReactChildDOM[t];e.renderMarkerChild(n,r)})}},{key:"renderMarkerChild",value:function(e,t){(0,c.render)(s.createElement("div",null,t),e)}},{key:"buildCreateOptions",value:function(e,t,n){var r={},i=["extData"];return v.MarkerAllProps.forEach(function(o){if(o in t&&-1===i.indexOf(o))r[o]=(0,v.getPropValue)(o,t[o]);else if(o in e)if((0,p.default)(e[o])){var a=e[o].call(null,t,n);r[o]=(0,v.getPropValue)(o,a)}else r[o]=(0,v.getPropValue)(o,e[o])}),r.extData=t,r}},{key:"componentWillReceiveProps",value:function(e){this.map&&this.refreshMarkersLayout(e)}},{key:"refreshMarkersLayout",value:function(e){var t=e.markers!==this.props.markers,n=!!this.props.useCluster!=!!e.useCluster;t&&(this.markersCache.length&&this.markersCache.forEach(function(e){e&&(e.setMap(null),e=null)}),this.markersCache=M.markersCache,this.createMarkers(e),this.setMarkerChild()),(t||n)&&this.markersWindow&&this.markersWindow.close(),n&&this.checkClusterSettings(e)}},{key:"loadClusterPlugin",value:function(e){var t=this;if(this.mapCluster)return Promise.resolve(this.mapCluster);var n="boolean"==typeof e?{}:e;return new Promise(function(e){t.map.plugin(["AMap.MarkerClusterer"],function(){e(t.createClusterPlugin(n))})})}},{key:"createClusterPlugin",value:function(e){var t={},n={minClusterSize:2,zoomOnClick:!1,maxZoom:18,gridSize:60,averageCenter:!0};C.forEach(function(r){t[r]=r in e?e[r]:n[r]}),this.mapCluster=new window.AMap.MarkerClusterer(this.map,[],t);var r={};return"events"in e&&"created"in(r=e.events)&&r.created(this.mapCluster),this.initClusterMarkerWindow(),this.bindClusterEvent(r),this.mapCluster}},{key:"onMarkerClick",value:function(e){var t=e.target;this.triggerMarkerClick(e,t)}},{key:"onMarkerHover",value:function(e){e.target.setTop(!0),this.setMarkerHovered(e,e.target)}},{key:"onMarkerHoverOut",value:function(e){e.target.setTop(!1),this.setMarkerHoverOut(e,e.target)}},{key:"onWindowMarkerClick",value:function(e){var t=e.markerRef;this.triggerMarkerClick(null,t)}},{key:"onWindowMarkerHover",value:function(e){var t=e.markerRef;this.setMarkerHovered(null,t)}},{key:"onWindowMarkerHoverOut",value:function(e){var t=e.markerRef;this.setMarkerHoverOut(null,t)}},{key:"setMarkerHovered",value:function(e,t){this.triggerMarkerHover(e,t)}},{key:"setMarkerHoverOut",value:function(e,t){this.triggerMarkerHoverOut(e,t)}},{key:"triggerMarkerClick",value:function(e,t){var n=this.props.events||{};(0,p.default)(n.click)&&n.click(e,t)}},{key:"triggerMarkerHover",value:function(e,t){var n=this.props.events||{};(0,p.default)(n.mouseover)&&n.mouseover(e,t)}},{key:"triggerMarkerHoverOut",value:function(e,t){var n=this.props.events||{};(0,p.default)(n.mouseout)&&n.mouseout(e,t)}},{key:"initClusterMarkerWindow",value:function(){this.markersWindow=new window.AMap.InfoWindow({isCustom:!0,autoMove:!0,closeWhenClickMap:!0,content:"<span>loading...</span>",showShadow:!1,offset:new window.AMap.Pixel(0,-20)}),this.markersDOM=document.createElement("div"),this.markersDOM.className="amap_markers_pop_window",this.markersWindow.setContent(this.markersDOM)}},{key:"bindClusterEvent",value:function(e){var t=this;this.mapCluster.on("click",function(n){var r=!0;(0,p.default)(e.click)&&(r=e.click(n)),!1!==r&&t.showMarkersInfoWindow(n)})}},{key:"showMarkersInfoWindow",value:function(e){var t=this,n=e.lnglat,r=e.markers;if(this.markersDOM.innerHTML="",r&&r.length){var i=r.length;if(i>42&&(r=r.slice(0,42)),r.forEach(function(e){var n=e.getContent(),r=document.createElement("div");r.className="window_marker_item",r.appendChild(n),r.markerRef=e,r.addEventListener("click",t.onWindowMarkerClick.bind(t,r),!0),r.addEventListener("mouseover",t.onWindowMarkerHover.bind(t,r),!0),r.addEventListener("mouseout",t.onWindowMarkerHoverOut.bind(t,r),!0),t.markersDOM.appendChild(r)}),i>42){var o=document.createElement("div");o.className="amap_markers_window_overflow_warning",o.innerText="更多坐标请放大地图查看",this.markersDOM.appendChild(o)}}this.markersWindow.open(this.map,n)}},{key:"exposeMarkerInstance",value:function(){if("events"in this.props){var e=this.props.events||{};(0,p.default)(e.created)&&e.created(this.markersCache)}}},{key:"bindMarkerEvents",value:function(e){var t=this.props.events||{},n=Object.keys(t),r=["click","mouseover","mouseout","created"];n.length&&n.forEach(function(n){-1===r.indexOf(n)&&e.on(n,t[n])})}},{key:"render",value:function(){return null}}]),t}(b);t.default=E},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(l),c=n(1),f=r(c),p=n(2),d=r(p),h=n(4),v=r(h),y=n(3),m=["center","radius","draggable","extData","visible","style"],b=m.concat(["zIndex","bubble"]),_=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return"undefined"!=typeof window&&(e.__map__?(n.map=e.__map__,n.element=n.map.getContainer(),n.initMapCircle(e)):d.default.warning("MAP_INSTANCE_REQUIRED")),n}return a(t,e),u(t,[{key:"componentWillReceiveProps",value:function(e){this.map&&this.refreshCircleLayout(e)}},{key:"initMapCircle",value:function(e){var t=this.buildCreateOptions(e);t.map=this.map,this.mapCircle=new window.AMap.Circle(t);var n=this.exposeCircleInstance(e);n&&this.bindCircleEvents(n),"visible"in e&&(e.visible||this.mapCircle.hide())}},{key:"buildCreateOptions",value:function(e){var t=this,n={};return b.forEach(function(r){if(r in e)if("style"===r&&void 0!==e.style){var i=Object.keys(e.style);i.forEach(function(t){n[t]=e.style[t]})}else"visible"!==r&&(n[r]=t.getSetterValue(r,e))}),n}},{key:"refreshCircleLayout",value:function(e){var t=this;m.forEach(function(n){if(n in e&&t.checkPropChanged(n,e))if("visible"===n)e.visible?t.mapCircle.show():t.mapCircle.hide();else if("style"===n)t.mapCircle.setOptions(e.style);else{var r="set"+(0,v.default)(n),i=t.getSetterValue(n,e);t.mapCircle[r](i)}})}},{key:"checkPropChanged",value:function(e,t){return this.props[e]!==t[e]}},{key:"getSetterValue",value:function(e,t){return"center"===e?(0,y.getAMapPosition)(t.center):t[e]}},{key:"exposeCircleInstance",value:function(e){if("events"in e){var t=e.events||{};return(0,f.default)(t.created)&&t.created(this.mapCircle),delete t.created,t}return!1}},{key:"bindCircleEvents",value:function(e){var t=this,n=Object.keys(e);n.length&&n.forEach(function(n){t.mapCircle.on(n,e[n])})}},{key:"renderEditor",value:function(e){return e?1!==s.Children.count(e)?null:s.cloneElement(s.Children.only(e),{__circle__:this.mapCircle,__map__:this.map,__ele__:this.element}):null}},{key:"render",value:function(){return this.renderEditor(this.props.children)}},{key:"componentWillUnmount",value:function(){this.mapCircle.hide(),this.mapCircle.setMap(null),delete this.mapCircle}}]),t}(s.Component);t.default=_},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),s=r(l),c=n(1),f=r(c),p=n(2),d=r(p),h=n(6),v=r(h),y=n(4),m=r(y),b=n(3),_=["path","draggable","extData","style","visible"],k=_.concat(["zIndex","bubble"]),g=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return"undefined"!=typeof window&&(e.__map__?(n.map=e.__map__,n.element=n.map.getContainer(),n.initMapPolygon(e)):d.default.warning("MAP_INSTANCE_REQUIRED")),n}return a(t,e),u(t,[{key:"componentWillReceiveProps",value:function(e){this.map&&this.refreshPolygonLayout(e)}},{key:"initMapPolygon",value:function(e){var t=this.buildCreateOptions(e);t.map=this.map,this.polygon=new window.AMap.Polygon(t);var n=this.exposeInstance();n&&this.bindOriginEvents(n),"visible"in e&&(e.visible?this.polygon.show():this.polygon.hide())}},{key:"buildCreateOptions",value:function(e){var t=this,n={};return k.forEach(function(r){if(r in e)if("style"===r&&e.style){var i=Object.keys(e.style);i.forEach(function(t){n[t]=e.style[t]})}else"visible"!==r&&(n[r]=t.getSetterValue(r,e[r]))}),n}},{key:"refreshPolygonLayout",value:function(e){var t=this;_.forEach(function(n){if(n in e&&t.detectPropChanged(n,e))if("visible"===n)e.visible?t.polygon.show():t.polygon.hide();else if("style"===n)t.polygon.setOptions(e.style);else{var r="set"+(0,m.default)(n),i=t.getSetterValue(n,e[n]);t.polygon[r](i)}})}},{key:"detectPropChanged",value:function(e,t){return this.props[e]!==t[e]}},{key:"getSetterValue",value:function(e,t){return"path"===e?this.buildPathValue(t):t}},{key:"buildPathValue",value:function(e){if(e.length){if(e[0][0]&&"number"==typeof e[0][0])return e.map(function(e){return(0,b.getAMapPosition)(e)});if("getLng"in e[0])return e;if("longitude"in e[0]||"lng"in e[0])return e.map(function(e){return(0,b.getAMapPosition)(e)});if(2===e.length){return[this.buildPathValue(e[0]),this.buildPathValue(e[1])]}return[]}return[]}},{key:"exposeInstance",value:function(){if("events"in this.props&&this.props.events){var e=this.props.events;return(0,f.default)(e.created)&&e.created(this.polygon),delete e.created,e}return!1}},{key:"bindOriginEvents",value:function(e){var t=this,n=Object.keys(e);n.length&&n.forEach(function(n){t.polygon.on(n,e[n])})}},{key:"renderEditor",value:function(e){if(!e)return null;if(1!==s.default.Children.count(e))return null;var t=s.default.Children.only(e);return t.type===v.default?s.default.cloneElement(t,{__poly__:this.polygon,__map__:this.map,__ele__:this.element}):null}},{key:"render",value:function(){return this.renderEditor(this.props.children)}},{key:"componentWillUnmount",value:function(){this.polygon.hide(),this.polygon.setMap(null),delete this.polygon}}]),t}(l.Component);t.default=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(l),c=n(1),f=r(c),p=n(2),d=r(p),h=n(6),v=r(h),y=n(4),m=r(y),b=n(3),_=s.Component,k=["path","extData","draggable","visible","style"],g=k.concat(["zIndex","bubble","showDir"]),w=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return"undefined"!=typeof window&&(e.__map__?(n.map=e.__map__,n.element=n.map.getContainer(),n.createMapPolyline(e)):d.default.warning("MAP_INSTANCE_REQUIRED")),n}return a(t,e),u(t,[{key:"componentWillReceiveProps",value:function(e){this.map&&this.refreshPolylineLayout(e)}},{key:"createMapPolyline",value:function(e){var t=this.buildCreateOptions(e);t.map=this.map,this.polyline=new window.AMap.Polyline(t);var n=this.exposeLineInstance(e);n&&this.bingLineEvents(n),"visible"in e&&(e.visible?this.polyline.show():this.polyline.hide())}},{key:"buildCreateOptions",value:function(e){var t=this,n={};return g.forEach(function(r){if(r in e)if("style"===r&&e.style){var i=Object.keys(e.style);i.forEach(function(t){n[t]=e.style[t]})}else"visible"!==r&&(n[r]=t.getSetterValue(r,e[r]))}),n}},{key:"refreshPolylineLayout",value:function(e){var t=this;k.forEach(function(n){if(n in e&&t.detectPropChanged(n,e))if("visible"===n)e.visible?t.polyline.show():t.polyline.hide();else if("style"===n)t.polyline.setOptions(e.style);else{var r="set"+(0,m.default)(n),i=t.getSetterValue(n,e[n]);t.polyline[r](i)}})}},{key:"detectPropChanged",value:function(e,t){return this.props[e]!==t[e]}},{key:"getSetterValue",value:function(e,t){return"path"===e?this.buildPathValue(t):t}},{key:"buildPathValue",value:function(e){return e.length?"getLng"in e[0]?e:e.map(function(e){return(0,b.getAMapPosition)(e)}):e}},{key:"exposeLineInstance",value:function(e){if("events"in e){var t=e.events;return(0,f.default)(t.created)&&t.created(this.polyline),delete t.created,t}return!1}},{key:"bingLineEvents",value:function(e){var t=this,n=Object.keys(e);n.length&&n.forEach(function(n){t.polyline.on(n,e[n])})}},{key:"renderEditor",value:function(e){if(!e)return null;if(1!==s.Children.count(e))return null;var t=s.Children.only(e);return t.type===v.default?s.cloneElement(t,{__poly__:this.polyline,__map__:this.map,__ele__:this.element}):null}},{key:"render",value:function(){return this.renderEditor(this.props.children)}},{key:"componentWillUnmount",value:function(){this.polyline.hide(),this.polyline.setMap(null),delete this.polyline}}]),t}(_);t.default=w},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(l),c=n(5),f=n(1),p=r(f),d=n(4),h=r(d),v=n(2),y=r(v),m=n(3),b=s.Component,_=["content","position","size","visible","offset"],k=_.concat(["isCustom","autoMove","closeWhenClickMap","showShadow"]),g=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return"undefined"!=typeof window&&(e.__map__?(n.map=e.__map__,n.element=n.map.getContainer(),n.isCustom=!0,n.createInfoWindow(e)):y.default.warning("MAP_INSTANCE_REQUIRED")),n}return a(t,e),u(t,[{key:"componentDidMount",value:function(){if(this.map){var e=this.props;"visible"in e&&(e.visible?(this.showWindow(),this.setClassName(e),this.setChild(e)):this.closeWindow())}}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"componentWillReceiveProps",value:function(e){this.map&&this.refreshWindowLayout(e)}},{key:"createInfoWindow",value:function(e){var t=this.buildCreateOptions(e);this.infoWindow=new window.AMap.InfoWindow(t);var n=this.exposeWindowInstance(e);n&&this.bindWindowEvents(n)}},{key:"refreshWindowLayout",value:function(e){var t=this;_.forEach(function(n){if(n in e&&t.checkPropChanged(n,e))if("visible"===n)e.visible?t.showWindow():t.closeWindow();else{var r="set"+(0,h.default)(n),i=t.getSetterValue(n,e[n]);t.infoWindow[r](i)}}),this.setChild(e),this.setClassName(e)}},{key:"checkPropChanged",value:function(e,t){return this.props[e]!==t[e]}},{key:"showWindow",value:function(){this.infoWindow.open(this.map,this.infoWindow.getPosition())}},{key:"closeWindow",value:function(){this.infoWindow.close()}},{key:"buildCreateOptions",value:function(e){var t=this,n={};return n.isCustom="isCustom"in e&&!!e.isCustom,"content"in e?n.content=e.content:(this.infoDOM=document.createElement("div"),n.content=this.infoDOM),k.forEach(function(r){r in e&&-1===["visible","isCustom","content"].indexOf(r)&&(n[r]=t.getSetterValue(r,e[r]))}),n}},{key:"getSetterValue",value:function(e,t){return"size"===e?(0,m.getAMapSize)(t):"offset"===e?(0,m.getAMapPixel)(t):"position"===e?(0,m.getAMapPosition)(t):t}},{key:"exposeWindowInstance",value:function(e){if("events"in e){var t=e.events||{};return(0,p.default)(t.created)&&t.created(this.infoWindow),delete t.created,t}return!1}},{key:"bindWindowEvents",value:function(e){var t=this,n=Object.keys(e);n.length&&n.forEach(function(n){t.infoWindow.on(n,e[n])})}},{key:"setChild",value:function(e){var t=e.children;this.infoDOM&&t?(0,c.render)(s.createElement("div",null,t),this.infoDOM):e.children&&console.warn("因为你设置 isCustom 为 true，InfoWindow 的 Children 被忽略")}},{key:"setClassName",value:function(e){var t="";!0===e.isCustom&&(t="amap_markers_pop_window "),this.infoDOM&&("className"in e&&e.className&&(t+=e.className),this.infoDOM.className=t)}},{key:"render",value:function(){return null}}]),t}(b);t.default=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(l),c=n(1),f=r(c),p=n(2),d=r(p),h={clickable:!1,opacity:1,visible:!0},v=["opacity","src","bounds","visible"],y=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return"undefined"!=typeof window&&(e.__map__?(n.map=e.__map__,n.element=n.map.getContainer(),n.createGroundImage(e)):d.default.warning("MAP_INSTANCE_REQUIRED")),n}return a(t,e),u(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"componentWillReceiveProps",value:function(e){this.map&&this.refreshGroundImage(e)}},{key:"refreshGroundImage",value:function(e){var t=this;v.forEach(function(n){n in e&&t.checkPropsChanged(e,n)&&("visible"===n?t.setVisible(e):"opacity"===n?t.setOpacity(e):"src"===n?t.setImageUrl(e):"bounds"===n&&t.setBounds(e))})}},{key:"setBounds",value:function(e){"setBounds"in this.image&&this.image.setBounds(this.buildBounds(e))}},{key:"setImageUrl",value:function(e){"setImageUrl"in this.image&&this.image.setImageUrl(e.src)}},{key:"setVisible",value:function(e){"show"in this.image&&(e.visible?this.image.show():this.image.hide())}},{key:"setOpacity",value:function(e){this.image.setOpacity(e.opacity)}},{key:"checkPropsChanged",value:function(e,t){return this.props[t]!==e[t]}},{key:"createGroundImage",value:function(e){var t=void 0,n=void 0,r=void 0,i=void 0;"src"in e?t=e.src:d.default.warning("SRC_REQUIRED",!0),"bounds"in e?n=this.buildBounds(e):d.default.warning("BOUNDS_REQUIRED",!0),i="clickable"in e?e.clickable:h.clickable,r="opacity"in e?e.opacity:h.opacity,this.image=new window.AMap.GroundImage(t,n,{map:this.map,clickable:i,opacity:r});var o=this.exopseImageInstance(e);o&&this.bindEvents(o)}},{key:"exopseImageInstance",value:function(e){if("events"in e){var t=e.events||{};return(0,f.default)(t.created)&&t.created(this.image),t}return!1}},{key:"bindEvents",value:function(e){var t=this,n=Object.keys(e);n.length&&n.forEach(function(n){"created"!==n&&t.image.on(n,e[n])})}},{key:"buildBounds",value:function(e){var t=e.bounds;return t?"getSouthWest"in t?t:new window.AMap.Bounds(new window.AMap.LngLat(t.sw.longitude,t.sw.latitude),new window.AMap.LngLat(t.ne.longitude,t.ne.latitude)):t}},{key:"render",value:function(){return null}},{key:"componentWillUnmount",value:function(){this.image.hide(),this.image.setMap(null),delete this.image}}]),t}(s.Component);t.default=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(l),c=n(2),f=r(c),p=n(1),d=r(p),h=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return"undefined"!=typeof window&&(e.__map__&&e.__circle__?(n.map=e.__map__,n.element=n.map.getContainer(),n.circle=e.__circle__,n.editorActive=!1,n.onPropsUpdate(e)):f.default.warning("CIRCLE_INSTANCE_REQUIRED")),n}return a(t,e),u(t,[{key:"componentWillReceiveProps",value:function(e){this.map&&this.onPropsUpdate(e)}},{key:"onPropsUpdate",value:function(e){"active"in e&&!1===e.active?this.toggleActive(!1,e):this.toggleActive(!0,e)}},{key:"toggleActive",value:function(e,t){e?this.editorActive||this.activeEditor(t):this.editorActive&&this.inactiveEditor()}},{key:"activeEditor",value:function(e){var t=this;this.loadCircleEditor(e).then(function(e){t.editorActive=!0,e.open()})}},{key:"inactiveEditor",value:function(){this.editorActive=!1,this.circleEditor&&this.circleEditor.close()}},{key:"loadCircleEditor",value:function(e){var t=this;return this.circleEditor?Promise.resolve(this.circleEditor):new Promise(function(n){t.map.plugin(["AMap.CircleEditor"],function(){n(t.createEditorInstance(e))})})}},{key:"createEditorInstance",value:function(e){this.circleEditor=new window.AMap.CircleEditor(this.map,this.circle);var t=this.exposeEditorInstance(e);return t&&this.bindEditorEvents(t),this.circleEditor}},{key:"exposeEditorInstance",value:function(e){if("events"in e){var t=e.events||{};return(0,d.default)(t.created)&&t.created(this.circleEditor),delete t.created,t}return!1}},{key:"bindEditorEvents",value:function(e){var t=this,n=Object.keys(e);n.length&&n.forEach(function(n){t.circleEditor.on(n,e[n])})}},{key:"render",value:function(){return null}}]),t}(s.Component);t.default=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(0),s=r(l),c=n(1),f=r(c),p=n(2),d=r(p),h=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return"undefined"!=typeof window&&(e.__map__?(n.map=e.__map__,n.loadToolInstance(e)):d.default.warning("MAP_INSTANCE_REQUIRED")),n}return a(t,e),u(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"loadToolInstance",value:function(e){var t=this;this.map.plugin(["AMap.MouseTool"],function(){t.createToolInstance(e)})}},{key:"createToolInstance",value:function(e){this.tool=new window.AMap.MouseTool(this.map);var t=e.events||{};return(0,f.default)(t.created)&&t.created(this.tool),(0,f.default)(t.draw)&&this.tool.on("draw",function(e){t.draw(e)}),this.tool}},{key:"render",value:function(){return null}}]),t}(s.default.Component);t.default=h}])});